%ul.nav.nav-tabs#topOfPage
  %li
    = link_to(t(:results), show_full_meeting_path(@meeting))
  %li
    = link_to(t(:ranking), show_ranking_meeting_path(@meeting))
  %li.disabled
    = link_to(t(:team_results), '#')
  %li.active
    = link_to(t(:swimmer_results), '#')

= render( partial: 'meeting_header' )

.row-fluid.span12
  .span3
    %h4= @swimmer.get_full_name
  .span1
    %h4= @swimmer.year_of_birth
  .span2
    %h4= @individual_result_list.first.get_category_and_gender_short
  .span6
    %h4
      %a{'id'=>"swimmer#{@swimmer.id}", 'href'=>"#{ show_team_results_meeting_path(:id=>@meeting.id, :team_id=>@individual_result_list.first.team_id) }", 'data-toggle' => 'tooltip', 'title' => I18n.t('meeting.show_team_results_tooltip')}
        = @swimmer.get_team_names

.row-fluid
  %table.table.table-striped.table-bordered.table-hover.table-condensed
    %tbody
      %tr
        %td.span4
        %td.span1.goggles-centeralign
          %i= I18n.t('activerecord.attributes.meeting_individual_result.rank')
        %td.span2.goggles-centeralign
        %td.span2.goggles-centeralign
          %i= I18n.t('activerecord.attributes.meeting_individual_result.standard_points')
        %td.span2.goggles-centeralign
          %i= I18n.t('activerecord.attributes.meeting_individual_result.meeting_points')
        %td.span1
        %td.span2.goggles-centeralign
          %i= I18n.t('records.personal_best')
        %td.span2.goggles-centeralign
          %i= I18n.t('records.seasonal_best')
        %td.span2.goggles-centeralign
          %i= I18n.t('records.meeting_best')

      - category_type_id = 0
      - gender_type_id   = 0
      - pool_type_id     = 0
      - if @individual_result_list.size > 0
        - category_type_code = @individual_result_list.first.get_category_type_code
        - category_type_id = @individual_result_list.first.get_category_type_id
        - gender_type_id = @individual_result_list.first.get_gender_type_id
        - pool_type_id = @individual_result_list.first.get_pool_type_id
        - meeting_id = @individual_result_list.first.meeting.id

      - @individual_result_list.each do |individual_result|
        - event_type_code = individual_result.get_event_type_code
        %tr
          %td.span3
            %b= individual_result.get_event_type_description
          %td.span1.goggles-rightalign
            = individual_result.is_disqualified ? 'DSQ' : individual_result.rank
          %td.span1.goggles-rightalign
            = individual_result.get_timing
          %td.span1.goggles-rightalign
            = sprintf( "%02.2f", individual_result.standard_points )
          %td.span1.goggles-rightalign
            = sprintf( "%02.2f", individual_result.meeting_individual_points )
          %td.span1
            = show_tag( individual_result.rank==1 && individual_result.is_valid_for_ranking, "medal_gold_3.png", '' )
            = show_tag( individual_result.rank==2 && individual_result.is_valid_for_ranking, "medal_silver_3.png", '' )
            = show_tag( individual_result.rank==3 && individual_result.is_valid_for_ranking, "medal_bronze_3.png", '' )
          %td.span1.goggles-rightalign
            - personal_bests = MeetingIndividualResult.get_records_for( event_type_code, category_type_code, gender_type_id, pool_type_id, nil, individual_result.swimmer_id )
            - if personal_bests.size > 0
              %p
                %a{'id'=>"rec#{individual_result.id}", 'href'=>"#{ show_full_meeting_path(:id=>personal_bests.first.meeting.id, :swimmer_id=>@swimmer.id) }", 'data-toggle' => 'tooltip', 'title' => I18n.t('meeting.show_swimmer_results_tooltip')}
                  = personal_bests.first.get_timing
            - else
              = ''
          %td.span1.goggles-td.goggles-rightalign
            - seasonal_bests = MeetingIndividualResult.get_records_for( event_type_code, category_type_id, gender_type_id, pool_type_id )
            - if seasonal_bests.size > 0
              %a{'id'=>"rec#{individual_result.id}", 'href'=>"#{ show_full_meeting_path(:id=>seasonal_bests.first.meeting.id, :swimmer_id=>seasonal_bests.first.swimmer_id) }", 'data-toggle' => 'tooltip', 'title' => I18n.t('meeting.show_swimmer_results_tooltip')}
                %p= seasonal_bests.first.get_timing
                %p= seasonal_bests.first.get_athlete_name
            - else
              = ''
          %td.span1.goggles-td.goggles-rightalign
            - meeting_bests  = MeetingIndividualResult.get_records_for( event_type_code, category_type_code, gender_type_id, nil, meeting_id )
            - if meeting_bests.size > 0
              %a{'id'=>"rec#{individual_result.id}", 'href'=>"#{ show_full_meeting_path(:id=>meeting_bests.first.meeting.id, :swimmer_id=>meeting_bests.first.swimmer_id) }", 'data-toggle' => 'tooltip', 'title' => I18n.t('meeting.show_swimmer_results_tooltip')}
                %p= meeting_bests.first.get_timing
                %p= meeting_bests.first.get_athlete_name
            - else
              = ''
